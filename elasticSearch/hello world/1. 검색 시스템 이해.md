
# 검색 시스템 이해

## 검색 시스템 기본 구조

수집기 -> 색인기 -> 스토리지 -> 검색기

&nbsp;

#### 수집기

일단 검색을 하려면 데이터가 있어야 되고, 어디선가 데이터를 수집해야 함. 수집기로는 크롤러, 스파이더 등이 있음.  수집 대상으로는 웹상의 대부분의 정보가 될 수 있음.

&nbsp;

#### 스토리지

DB와 같은 물리적인 저장소. 수집한 데이터를 스토리지에 보관한다.

&nbsp;

#### 색인기

수집기가 수집한 정보를 사용자 질의로 검색할 수 있어야 하는데, 색인기가 수집된 데이터를 검색 가능한 구조로 가공하고 저장한다. 색인기는 다양한 형태소 분석기를 조합해 수집한 정보에서 의미가 있는 용어를 추출하고 검색에 유리한 역색인 구조로 데이터를 저장한다.

&nbsp;

#### 검색기

검색기는 사용자 질의를 입력받아 색인기에서 저장한 역색인 구조에서 일치하는 문서를 찾아서 반환한다. 검색기도 색인기처럼 형태소 분석기를 사용하여 사용자 질의에서 유의미한 용어를 추출해 검색한다. 사용하는 형태소 분석기에 따라 검색 품질이 달라질 수 있다.

&nbsp;
&nbsp;

## RDBMS와의 차이점

DB에서 '가마돈' 이라는 데이터를 SQL로 조회하기 위해서는 Like를 이용한다. 

```sql
SELECT * FROM USER WHERE Name like '%가마돈%'

(결과)
ID   Name      Location     Gender    Date
1    가마돈     서울         남        2018-05-12
```

&nbsp;

엘라스틱서치에서는 검색엔진이 제공하는 Search API를 사용한다.

```json
GET http://localhost:9200/user/_search?q=Name:가마돈

(결과)
{
	"ID": 1,
	"Name": "가마돈",
	"Location": "서울",
	"Gender": "남",
	"Date": "2018-05-12"
}
```

&nbsp;

만약 가마돈이 영문(garmadon) 이었다면, SQL에서는 대소문자 처리가 유연하지 못하다. 엘라스틱서치에서는 사용자가 쿼리로 'GARMADON', 'garmadon', 'GarMadon' 등이 들어와도 검색이 가능하게 할 수 있다.

&nbsp;

RDB에서는 스키마를 미리 정의해야 저장, 조회가 가능한 반면 엘라스틱서치는 구조화되지 않은 비정형 데이터를 스스로 분석해 자동으로 필드를 생성하고 저장한다.

